<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>Daniil Kovalenok</title>
		<meta name="description" content="Personal page" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="style.css" />
		<link rel="icon" type="image/png" href="favicon.ico" />
	</head>
	<body>
		<canvas width="2000" height="2000" id="canvas"></canvas>
		<main>
			<h1>DANIIL KOVALENOK</h1>
			<ul>
				<li><img src="javascript.svg" height="36"  /></li>
				<li><img src="react.svg" height="36"  /></li>
				<li><img src="rust.svg" height="36" /></li>
			</ul>
			<h2>Full-stack Developer</h2>
			<p><a href="https://github.com/jiftoo/">GitHub</a></p>
			<p><a href="https://www.linkedin.com/in/daniil-kovalyonok-jiftoo">LinkedIn</a></p>
			<p><a href="mailto:contact@jiftoo.dev">contact@jiftoo.dev</a></p>
		</main>
		<script>
			/** @type {HTMLCanvasElement} */
			let canvas = document.getElementById("canvas");
			let ctx = canvas.getContext("2d");
			window.addEventListener("resize", () => {
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
				ctx.fillStyle = "whitesmoke";
			});
			window.dispatchEvent(new Event("resize"));

			function genRandomSeries(steps, mag) {
				let randomValues = Array(steps)
					.fill(0)
					.map(() => Math.random());
				const randomInMag = (i) => randomValues[i] * mag * 2 - mag;

				let coefs = Array(steps)
					.fill(0)
					.map((_, i) => randomInMag(i) + randomInMag(i) / 2);
				let sineFuncs = coefs.map((coef, i) => {
					let fn = Math.sin;
					return (x) => coef * fn(x + randomInMag(i)) + randomInMag(i) / 2;
				});

				return function (x) {
					return sineFuncs.reduce((acc, func) => acc + func(x), 0);
				};
			}

			function renderSeries(series, i) {
				step = 400;
				let start = [0, Math.min(Math.max(series(10) + 400, 300), 350)];

				ctx.beginPath();
				ctx.moveTo(start[0], start[1]);
				let lastX = start[0];
				let lastY = start[1];
				for (let i = 1; i < canvas.width / step + 10; i++) {
					let x = i * step;
					let y = start[1] + series(x);
					let y2 = start[1] + series(x);
					ctx.bezierCurveTo(lastX / 2 + x / 2, lastY, lastX / 2 + x / 2, y, x, y);
					lastX = x;
					lastY = y;
				}
				ctx.stroke();
			}

			const gradient = ctx.createLinearGradient(0, 0, 2000, 2000);
			gradient.addColorStop(0, "rgba(255, 166, 0, 0.25)");
			gradient.addColorStop(0.65, "rgba(255, 0, 255, 0.25)");
			gradient.addColorStop(1, "rgba(0, 128, 255, 0.5)");

			let seriesCount = 2;
			let seriesArray = Array(seriesCount)
				.fill(0)
				.map(() => genRandomSeries(115, 8));
			let shift = -110;

			function animate(time) {
				ctx.fillRect(0, 0, canvas.width, canvas.height);
				ctx.strokeStyle = gradient;
				ctx.lineWidth = 50;
				ctx.filter = "blur(1px)";
				shift -= 0.01;

				seriesArray.forEach((series, i) => {
					ctx.translate(shift, 0);
					renderSeries(series, i);
				});
				ctx.translate(-shift * seriesCount, 0);

				ctx.lineWidth = 10;
				ctx.strokeStyle = "rgba(255,255,255,0.2)";
				let trBack = 40;
				seriesArray.forEach((series, i) => {
					ctx.translate(shift, 0);
					renderSeries(series, i);
				});
				ctx.translate(-shift * seriesCount, 0);

				seriesArray = seriesArray.map((series, i) => {
					const parallax = (x) => x * (i / 1000000); //?
					return (x) => series(x + parallax(x) + 0.0021);
				});

				window.requestAnimationFrame(animate);
			}
			animate(0);
		</script>
	</body>
</html>
